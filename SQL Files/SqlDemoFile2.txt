use Sep19CHN

create schema Bindhu

create table Bindhu.Employee
(
EmpId int identity(161549,1) primary key,
EmpName varchar(20),
EmpLocation varchar(20),
EmpContact bigint,
)

--create insert command
insert into Bindhu.Employee values('BindhuPrashanthi', 'Chennai', '9966097578')
--Read
select * from Bindhu.Employee
--Update
update Bindhu.Employee set EmpLocation='Bangalore' where EmpId=161549
--Delete
delete from Bindhu.Employee where EmpLocation='Chennai'
--Search and Read
select * from Bindhu.Employee where EmpId>=1000

insert into Bindhu.Employee values('Prashanthi', 'Chennai', '9966097578')
insert into Bindhu.Employee values('Robert', 'Bangalore', '9999900000')
insert into Bindhu.Employee values('James', 'Hyderabad', '9988776655')

select * from Bindhu.Employee

--To get next generated Id
select ident_current('Bindhu.Employee') + ident_incr('Bindhu.Employee')

sp_tables  --built in procedures
--create procedure
--usp is user defined procedure
create proc Bindhu.usp_DisplayEmployee 
@eId int
AS
BEGIN
select * from Bindhu.Employee where EmpId=@eId
END

Exec Bindhu.usp_DisplayEmployee 161549

--insert procedure
create proc Bindhu.usp_AddEmployee
@eName varchar(20),
@eLoc varchar(20),
@ePh bigint
AS
BEGIN
insert into Bindhu.Employee values(@eName, @eLoc, @ePh)
END

exec Bindhu.usp_AddEmployee 'Alex', 'Goa', 890890768
select * from Bindhu.Employee

--update procedure
create proc Bindhu.usp_EditEmployee
@eName varchar(20),
@eLoc varchar(20),
@ePh bigint,
@eId int
AS
BEGIN
update Bindhu.Employee set EmpName=@eName,EmpLocation=@eLoc,EmpContact=@ePh
where EmpId=@eId
END

exec Bindhu.usp_EditEmployee 'Geetha', 'Calcutta', 8889990007, 161551
select * from Bindhu.Employee

--procedure to retrieve next autogenerated Id
create proc Bindhu.usp_NextEmpId
@newEmpId int out
AS 
BEGIN
set @newEmpId = (select IDENT_CURRENT('Bindhu.Employee') + IDENT_INCR('Bindhu.Employee'))
END

declare @newId int
exec Bindhu.usp_NextEmpId @newId out
select @newId as NextEmployeeId